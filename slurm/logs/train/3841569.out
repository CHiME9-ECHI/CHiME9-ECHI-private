[2025-06-27 19:41:07,664][root][INFO] - Hydra config:
paths:
  root: data
  scratch: data/scratch
  echi: data/chime9_echi
  experiments_dir: data/scratch/experiments
  enhanced_dir: data/scratch/experiments/baseline_ha/inference/{dataset}_submission
  signal_id: '{session}.{device}.{pid}'
  signal_dir: data/chime9_echi/{device}/{dataset}
  echi_signal: data/chime9_echi/{device}/{dataset}/{session}.{device}.wav
  ref_signal_dir: data/chime9_echi/ref/{dataset}
  ref_signal_file: data/chime9_echi/ref/{dataset}/{session}.{device}.{pid}.wav
  rainbow_signal_dir: data/chime9_echi/participant/{dataset}
  rainbow_signal_file: data/chime9_echi/participant/{dataset}/{pid}.wav
  sessions_file: data/chime9_echi/metadata/sessions.{dataset}.csv
  segment_info_dir: data/chime9_echi/metadata/ref/{dataset}
  segment_info_file: data/chime9_echi/metadata/ref/{dataset}/{session}.{device}.{pid}.csv
  ref_segment_dir: data/scratch/ref_segments/{dataset}/{device}/{segment_type}
  train_input_dir: data/scratch/train_segments/{dataset}/{device}
  train_input_file: data/scratch/train_segments/{dataset}/{device}/{session}.{device}.{pid}.{segment}.wav
  train_target_dir: data/scratch/train_segments/{dataset}/{device}_ref
  train_target_file: data/scratch/train_segments/{dataset}/{device}_ref/{session}.{device}.{pid}.{segment}.wav
  segment_dir: data/scratch/experiments/baseline_ha/train/segments/{device}/{segment_type}
  results_file: data/scratch/experiments/baseline_ha/train/results/results.{dataset}.{device}.{segment_type}.json
  report_file: data/scratch/experiments/baseline_ha/train/reports/report.{dataset}.{device}.{segment_type}.{session}.{pid}.json
  enhanced_signal: data/scratch/experiments/baseline_ha/inference/{dataset}_submission/{session}.{device}.{pid}.wav
shared:
  exp_name: baseline_ha
  sample_rate: 16000
  signal_bitdepth: PCM_16
  nchannels: 1
unpack:
  noisy_input_file: data/chime9_echi/{device}/{dataset}/{session}.{device}.wav
  ref_input_file: data/chime9_echi/ref/{dataset}/{session}.{device}.{pid}.wav
  segment_info_file: data/chime9_echi/metadata/ref/{dataset}/{session}.{device}.{pid}.csv
  segment_sample_rate: 16000
  noisy_output_dir: data/scratch/train_segments/{dataset}/{device}
  ref_output_dir: data/scratch/train_segments/{dataset}/{device}_ref
  dataset:
  - train
  - dev
  devices: ha
  sessions_file: data/chime9_echi/metadata/sessions.{dataset}.csv
  run: true
dataloading:
  device: ha
  noisy_signal: data/scratch/train_segments/{dataset}/{device}/{session}.{device}.{pid}.{segment}.wav
  ref_signal: data/scratch/train_segments/{dataset}/{device}_ref/{session}.{device}.{pid}.{segment}.wav
  rainbow_signal: data/chime9_echi/participant/{dataset}/{pid}.wav
  sessions_file: data/chime9_echi/metadata/sessions.{dataset}.csv
  segments_file: data/chime9_echi/metadata/ref/{dataset}/{session}.{device}.{pid}.csv
  signal:
    noisy_sr: 48000
    ref_sr: 16000
    spkid_sr: 48000
  loader:
    train:
      batch_size: 1
      num_workers: 0
      shuffle: true
      pin_memory: true
    dev:
      batch_size: 1
      num_workers: 0
      shuffle: false
      pin_memory: true
train:
  epochs: 100
  checkpoint_interval: 2
  lr: 1.0e-06
  clip_grad_norm: 1.0
  schedule_lr:
    name: plateau_reduce
    params:
      mode: min
      factor: 0.5
      patience: 2
      threshold: 0.1
      min_lr: 1.0e-08
  loss:
    name: spec
    kwargs:
      fft_size: 1024
      hop_size: 256
      win_length: 1024
      window: hann_window
      w_sc: 1.0
      w_log_mag: 1.0
      w_lin_mag: 0.0
      w_phs: 0.0
      sample_rate: null
      scale: null
      n_bins: null
      perceptual_weighting: false
      scale_invariance: false
      eps: 1.0e-08
      output: loss
      reduction: mean
      mag_distance: L1
  run: true
model:
  name: baseline
  input:
    sample_rate: 16000
    channels: 7
    rms: 0.05
    use_spkid: true
    type: stft
    stft:
      n_fft: 128
      win_length: 128
      hop_length: 64
      window: hann
  params:
    n_srcs: 1
    n_imics: 7
    n_layers: 3
    lstm_hidden_units: 128
    attn_n_head: 4
    attn_qk_output_channel: 128
    emb_dim: 64
    emb_ks: 4
    emb_hs: 1
    activation: prelu
    eps: 1.0e-05
device: ha
sample_rate: 16000
debug: false
wandb:
  entity: robbiesuth97-university-of-sheffield
  project: echi-baseline
base_dir: data/scratch/experiments/baseline_ha/train

[2025-06-27 19:41:07,667][root][INFO] - Preparing the ECHI dataset
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:06<13:05,  6.60s/it]  2%|▏         | 2/120 [00:11<11:25,  5.81s/it]  2%|▎         | 3/120 [00:16<10:04,  5.17s/it]  3%|▎         | 4/120 [00:22<10:44,  5.56s/it]  4%|▍         | 5/120 [00:27<10:16,  5.36s/it]  5%|▌         | 6/120 [00:31<09:32,  5.03s/it]  6%|▌         | 7/120 [00:36<09:04,  4.82s/it]  7%|▋         | 8/120 [00:40<08:38,  4.63s/it]  8%|▊         | 9/120 [00:45<08:36,  4.65s/it]  8%|▊         | 10/120 [00:50<09:01,  4.92s/it]  9%|▉         | 11/120 [00:55<08:37,  4.75s/it] 10%|█         | 12/120 [00:59<08:24,  4.67s/it] 11%|█         | 13/120 [01:05<08:56,  5.01s/it] 12%|█▏        | 14/120 [01:09<08:13,  4.65s/it] 12%|█▎        | 15/120 [01:13<07:56,  4.54s/it] 13%|█▎        | 16/120 [01:20<09:01,  5.21s/it] 14%|█▍        | 17/120 [01:24<08:21,  4.87s/it] 15%|█▌        | 18/120 [01:29<08:16,  4.86s/it] 16%|█▌        | 19/120 [01:33<08:11,  4.86s/it] 17%|█▋        | 20/120 [01:38<07:58,  4.78s/it] 18%|█▊        | 21/120 [01:42<07:33,  4.58s/it] 18%|█▊        | 22/120 [01:48<08:08,  4.98s/it] 19%|█▉        | 23/120 [01:53<07:49,  4.84s/it] 20%|██        | 24/120 [01:57<07:24,  4.63s/it] 21%|██        | 25/120 [02:03<08:03,  5.09s/it] 22%|██▏       | 26/120 [02:08<07:48,  4.98s/it] 22%|██▎       | 27/120 [02:13<07:53,  5.09s/it] 23%|██▎       | 28/120 [02:18<07:58,  5.20s/it] 24%|██▍       | 29/120 [02:23<07:32,  4.97s/it] 25%|██▌       | 30/120 [02:28<07:27,  4.98s/it] 26%|██▌       | 31/120 [02:33<07:16,  4.91s/it] 27%|██▋       | 32/120 [02:38<07:17,  4.97s/it] 28%|██▊       | 33/120 [02:42<06:53,  4.75s/it] 28%|██▊       | 34/120 [02:47<06:51,  4.79s/it] 29%|██▉       | 35/120 [02:52<06:51,  4.84s/it] 30%|███       | 36/120 [02:56<06:36,  4.72s/it] 31%|███       | 37/120 [03:02<06:58,  5.04s/it] 32%|███▏      | 38/120 [03:07<06:54,  5.05s/it] 32%|███▎      | 39/120 [03:11<06:22,  4.73s/it] 33%|███▎      | 40/120 [03:16<06:23,  4.80s/it] 34%|███▍      | 41/120 [03:21<06:19,  4.81s/it] 35%|███▌      | 42/120 [03:25<05:56,  4.57s/it] 36%|███▌      | 43/120 [03:31<06:30,  5.07s/it] 37%|███▋      | 44/120 [03:36<06:14,  4.93s/it] 38%|███▊      | 45/120 [03:40<05:54,  4.73s/it] 38%|███▊      | 46/120 [03:45<05:54,  4.79s/it] 39%|███▉      | 47/120 [03:50<05:54,  4.86s/it] 40%|████      | 48/120 [03:55<05:45,  4.80s/it] 41%|████      | 49/120 [03:59<05:27,  4.61s/it] 42%|████▏     | 50/120 [04:03<05:14,  4.50s/it] 42%|████▎     | 51/120 [04:08<05:30,  4.79s/it] 43%|████▎     | 52/120 [04:14<05:33,  4.90s/it] 44%|████▍     | 53/120 [04:17<04:57,  4.45s/it] 45%|████▌     | 54/120 [04:20<04:33,  4.15s/it] 46%|████▌     | 55/120 [04:26<04:57,  4.57s/it] 47%|████▋     | 56/120 [04:30<04:46,  4.48s/it] 48%|████▊     | 57/120 [04:35<04:53,  4.66s/it] 48%|████▊     | 58/120 [04:41<05:08,  4.98s/it] 49%|████▉     | 59/120 [04:45<04:39,  4.58s/it] 50%|█████     | 60/120 [04:49<04:28,  4.48s/it] 51%|█████     | 61/120 [04:55<04:56,  5.02s/it] 52%|█████▏    | 62/120 [04:59<04:32,  4.70s/it] 52%|█████▎    | 63/120 [05:04<04:29,  4.72s/it] 53%|█████▎    | 64/120 [05:09<04:28,  4.79s/it] 54%|█████▍    | 65/120 [05:14<04:23,  4.79s/it] 55%|█████▌    | 66/120 [05:18<04:13,  4.69s/it] 56%|█████▌    | 67/120 [05:24<04:21,  4.93s/it] 57%|█████▋    | 68/120 [05:29<04:15,  4.92s/it] 57%|█████▊    | 69/120 [05:33<04:06,  4.84s/it] 58%|█████▊    | 70/120 [05:37<03:39,  4.38s/it] 59%|█████▉    | 71/120 [05:40<03:23,  4.14s/it] 60%|██████    | 72/120 [05:44<03:18,  4.14s/it] 61%|██████    | 73/120 [05:51<03:53,  4.98s/it] 62%|██████▏   | 74/120 [05:57<03:53,  5.08s/it] 62%|██████▎   | 75/120 [06:01<03:35,  4.78s/it] 63%|██████▎   | 76/120 [06:05<03:31,  4.80s/it] 64%|██████▍   | 77/120 [06:10<03:26,  4.79s/it] 65%|██████▌   | 78/120 [06:14<03:10,  4.54s/it] 66%|██████▌   | 79/120 [06:19<03:06,  4.55s/it] 67%|██████▋   | 80/120 [06:23<03:01,  4.53s/it] 68%|██████▊   | 81/120 [06:27<02:48,  4.31s/it] 68%|██████▊   | 82/120 [06:33<03:05,  4.87s/it] 69%|██████▉   | 83/120 [06:39<03:05,  5.02s/it] 70%|███████   | 84/120 [06:42<02:48,  4.69s/it] 71%|███████   | 85/120 [06:48<02:49,  4.84s/it] 72%|███████▏  | 86/120 [06:52<02:39,  4.70s/it] 72%|███████▎  | 87/120 [06:56<02:24,  4.37s/it] 73%|███████▎  | 88/120 [07:00<02:22,  4.45s/it] 74%|███████▍  | 89/120 [07:05<02:18,  4.47s/it] 75%|███████▌  | 90/120 [07:10<02:20,  4.67s/it] 76%|███████▌  | 91/120 [07:16<02:24,  4.97s/it] 77%|███████▋  | 92/120 [07:21<02:18,  4.95s/it] 78%|███████▊  | 93/120 [07:26<02:14,  4.98s/it] 78%|███████▊  | 94/120 [07:31<02:16,  5.25s/it] 79%|███████▉  | 95/120 [07:35<02:00,  4.81s/it] 80%|████████  | 96/120 [07:40<01:54,  4.76s/it] 81%|████████  | 97/120 [07:46<01:55,  5.03s/it] 82%|████████▏ | 98/120 [07:50<01:48,  4.92s/it] 82%|████████▎ | 99/120 [07:55<01:43,  4.91s/it] 83%|████████▎ | 100/120 [08:02<01:49,  5.49s/it] 84%|████████▍ | 101/120 [08:06<01:37,  5.14s/it] 85%|████████▌ | 102/120 [08:11<01:31,  5.06s/it] 86%|████████▌ | 103/120 [08:16<01:25,  5.04s/it] 87%|████████▋ | 104/120 [08:20<01:14,  4.69s/it] 88%|████████▊ | 105/120 [08:24<01:06,  4.42s/it] 88%|████████▊ | 106/120 [08:29<01:06,  4.72s/it] 89%|████████▉ | 107/120 [08:33<00:58,  4.48s/it] 90%|█████████ | 108/120 [08:38<00:55,  4.65s/it] 91%|█████████ | 109/120 [08:43<00:51,  4.68s/it] 92%|█████████▏| 110/120 [08:48<00:47,  4.76s/it] 92%|█████████▎| 111/120 [08:53<00:44,  4.92s/it] 93%|█████████▎| 112/120 [08:59<00:41,  5.21s/it] 94%|█████████▍| 113/120 [09:04<00:36,  5.18s/it] 95%|█████████▌| 114/120 [09:08<00:28,  4.77s/it] 96%|█████████▌| 115/120 [09:14<00:25,  5.03s/it] 97%|█████████▋| 116/120 [09:19<00:20,  5.04s/it] 98%|█████████▊| 117/120 [09:23<00:14,  4.86s/it] 98%|█████████▊| 118/120 [09:28<00:09,  4.97s/it] 99%|█████████▉| 119/120 [09:32<00:04,  4.71s/it]100%|██████████| 120/120 [09:38<00:00,  4.84s/it]100%|██████████| 120/120 [09:38<00:00,  4.82s/it]
  0%|          | 0/120 [00:00<?, ?it/s]  1%|          | 1/120 [00:02<05:48,  2.93s/it]  2%|▏         | 2/120 [00:05<05:04,  2.58s/it]  2%|▎         | 3/120 [00:07<04:24,  2.26s/it]  3%|▎         | 4/120 [00:08<03:56,  2.04s/it]  4%|▍         | 5/120 [00:10<03:52,  2.02s/it]  5%|▌         | 6/120 [00:12<03:33,  1.87s/it]  6%|▌         | 7/120 [00:13<03:05,  1.64s/it]  7%|▋         | 8/120 [00:15<03:19,  1.78s/it]  8%|▊         | 9/120 [00:17<03:09,  1.70s/it]  8%|▊         | 10/120 [00:19<03:15,  1.77s/it]  9%|▉         | 11/120 [00:21<03:17,  1.81s/it] 10%|█         | 12/120 [00:22<03:08,  1.74s/it] 11%|█         | 13/120 [00:24<03:11,  1.79s/it] 12%|█▏        | 14/120 [00:26<03:02,  1.72s/it] 12%|█▎        | 15/120 [00:27<02:54,  1.66s/it] 13%|█▎        | 16/120 [00:29<03:05,  1.79s/it] 14%|█▍        | 17/120 [00:30<02:46,  1.62s/it] 15%|█▌        | 18/120 [00:32<02:51,  1.68s/it] 16%|█▌        | 19/120 [00:34<02:43,  1.62s/it] 17%|█▋        | 20/120 [00:36<02:51,  1.71s/it] 18%|█▊        | 21/120 [00:37<02:43,  1.65s/it] 18%|█▊        | 22/120 [00:39<02:52,  1.76s/it] 19%|█▉        | 23/120 [00:41<02:45,  1.70s/it] 20%|██        | 24/120 [00:43<02:54,  1.82s/it] 21%|██        | 25/120 [00:45<03:05,  1.95s/it] 22%|██▏       | 26/120 [00:47<03:07,  1.99s/it] 22%|██▎       | 27/120 [00:49<03:08,  2.03s/it] 23%|██▎       | 28/120 [00:51<03:02,  1.99s/it] 24%|██▍       | 29/120 [00:53<02:55,  1.93s/it] 25%|██▌       | 30/120 [00:55<02:58,  1.98s/it] 26%|██▌       | 31/120 [00:57<02:42,  1.82s/it] 27%|██▋       | 32/120 [00:59<02:46,  1.89s/it] 28%|██▊       | 33/120 [01:00<02:35,  1.79s/it] 28%|██▊       | 34/120 [01:02<02:25,  1.69s/it] 29%|██▉       | 35/120 [01:03<02:28,  1.75s/it] 30%|███       | 36/120 [01:05<02:28,  1.76s/it] 31%|███       | 37/120 [01:07<02:30,  1.81s/it] 32%|███▏      | 38/120 [01:09<02:29,  1.82s/it] 32%|███▎      | 39/120 [01:11<02:40,  1.98s/it] 33%|███▎      | 40/120 [01:13<02:31,  1.89s/it] 34%|███▍      | 41/120 [01:15<02:20,  1.78s/it] 35%|███▌      | 42/120 [01:16<02:03,  1.59s/it] 36%|███▌      | 43/120 [01:18<02:21,  1.84s/it] 37%|███▋      | 44/120 [01:20<02:10,  1.72s/it] 38%|███▊      | 45/120 [01:22<02:17,  1.84s/it] 38%|███▊      | 46/120 [01:24<02:16,  1.85s/it] 39%|███▉      | 47/120 [01:26<02:23,  1.97s/it] 40%|████      | 48/120 [01:28<02:15,  1.88s/it] 41%|████      | 49/120 [01:28<01:52,  1.58s/it] 42%|████▏     | 50/120 [01:30<01:49,  1.56s/it] 42%|████▎     | 51/120 [01:32<01:53,  1.65s/it] 43%|████▎     | 52/120 [01:33<01:46,  1.56s/it] 44%|████▍     | 53/120 [01:34<01:36,  1.44s/it] 45%|████▌     | 54/120 [01:35<01:29,  1.35s/it] 46%|████▌     | 55/120 [01:37<01:30,  1.39s/it] 47%|████▋     | 56/120 [01:39<01:41,  1.58s/it] 48%|████▊     | 57/120 [01:41<01:43,  1.64s/it] 48%|████▊     | 58/120 [01:43<01:47,  1.73s/it] 49%|████▉     | 59/120 [01:44<01:36,  1.58s/it] 50%|█████     | 60/120 [01:45<01:34,  1.58s/it] 51%|█████     | 61/120 [01:47<01:39,  1.69s/it] 52%|█████▏    | 62/120 [01:49<01:31,  1.58s/it] 52%|█████▎    | 63/120 [01:50<01:28,  1.55s/it] 53%|█████▎    | 64/120 [01:52<01:25,  1.53s/it] 54%|█████▍    | 65/120 [01:53<01:21,  1.49s/it] 55%|█████▌    | 66/120 [01:55<01:19,  1.48s/it] 56%|█████▌    | 67/120 [01:56<01:14,  1.40s/it] 57%|█████▋    | 68/120 [01:58<01:23,  1.60s/it] 57%|█████▊    | 69/120 [01:59<01:21,  1.60s/it] 58%|█████▊    | 70/120 [02:01<01:12,  1.44s/it] 59%|█████▉    | 71/120 [02:02<01:08,  1.39s/it] 60%|██████    | 72/120 [02:03<01:10,  1.47s/it] 61%|██████    | 73/120 [02:06<01:18,  1.68s/it] 62%|██████▏   | 74/120 [02:07<01:20,  1.74s/it] 62%|██████▎   | 75/120 [02:09<01:21,  1.81s/it] 63%|██████▎   | 76/120 [02:11<01:12,  1.64s/it] 64%|██████▍   | 77/120 [02:12<01:08,  1.60s/it] 65%|██████▌   | 78/120 [02:14<01:04,  1.53s/it] 66%|██████▌   | 79/120 [02:15<00:58,  1.42s/it] 67%|██████▋   | 80/120 [02:17<01:02,  1.55s/it] 68%|██████▊   | 81/120 [02:18<00:58,  1.49s/it] 68%|██████▊   | 82/120 [02:20<00:58,  1.55s/it] 69%|██████▉   | 83/120 [02:22<01:01,  1.66s/it] 70%|███████   | 84/120 [02:23<00:57,  1.61s/it] 71%|███████   | 85/120 [02:24<00:53,  1.54s/it] 72%|███████▏  | 86/120 [02:26<00:49,  1.46s/it] 72%|███████▎  | 87/120 [02:26<00:41,  1.25s/it] 73%|███████▎  | 88/120 [02:28<00:44,  1.39s/it] 74%|███████▍  | 89/120 [02:30<00:47,  1.53s/it] 75%|███████▌  | 90/120 [02:32<00:46,  1.55s/it] 76%|███████▌  | 91/120 [02:33<00:47,  1.65s/it] 77%|███████▋  | 92/120 [02:35<00:48,  1.72s/it] 78%|███████▊  | 93/120 [02:38<00:50,  1.87s/it] 78%|███████▊  | 94/120 [02:39<00:46,  1.77s/it] 79%|███████▉  | 95/120 [02:40<00:40,  1.62s/it] 80%|████████  | 96/120 [02:42<00:38,  1.60s/it] 81%|████████  | 97/120 [02:44<00:40,  1.76s/it] 82%|████████▏ | 98/120 [02:46<00:38,  1.77s/it] 82%|████████▎ | 99/120 [02:48<00:36,  1.76s/it] 83%|████████▎ | 100/120 [02:50<00:38,  1.92s/it] 84%|████████▍ | 101/120 [02:52<00:34,  1.83s/it] 85%|████████▌ | 102/120 [02:53<00:31,  1.77s/it] 86%|████████▌ | 103/120 [02:55<00:30,  1.80s/it] 87%|████████▋ | 104/120 [02:56<00:25,  1.62s/it] 88%|████████▊ | 105/120 [02:58<00:23,  1.57s/it] 88%|████████▊ | 106/120 [02:59<00:21,  1.56s/it] 89%|████████▉ | 107/120 [03:01<00:20,  1.55s/it] 90%|█████████ | 108/120 [03:03<00:20,  1.72s/it] 91%|█████████ | 109/120 [03:04<00:18,  1.69s/it] 92%|█████████▏| 110/120 [03:06<00:16,  1.69s/it] 92%|█████████▎| 111/120 [03:08<00:15,  1.76s/it] 93%|█████████▎| 112/120 [03:10<00:14,  1.86s/it] 94%|█████████▍| 113/120 [03:12<00:13,  1.91s/it] 95%|█████████▌| 114/120 [03:14<00:10,  1.78s/it] 96%|█████████▌| 115/120 [03:16<00:09,  1.82s/it] 97%|█████████▋| 116/120 [03:18<00:07,  1.92s/it] 98%|█████████▊| 117/120 [03:19<00:05,  1.81s/it] 98%|█████████▊| 118/120 [03:21<00:03,  1.81s/it] 99%|█████████▉| 119/120 [03:23<00:01,  1.69s/it]100%|██████████| 120/120 [03:25<00:00,  1.77s/it]100%|██████████| 120/120 [03:25<00:00,  1.71s/it]
[2025-06-27 19:54:29,393][root][ERROR] - Invalid # of channels. Requested 7 channels but audio only has 4
[2025-06-27 19:54:29,795][root][ERROR] - Invalid # of channels. Requested 7 channels but audio only has 4
[2025-06-27 19:54:30,212][root][ERROR] - Invalid # of channels. Requested 7 channels but audio only has 4
[2025-06-27 19:54:34,732][root][ERROR] - Invalid # of channels. Requested 7 channels but audio only has 4
[2025-06-27 19:54:34,855][root][ERROR] - Invalid # of channels. Requested 7 channels but audio only has 4
[2025-06-27 19:54:35,060][root][ERROR] - Invalid # of channels. Requested 7 channels but audio only has 4
/fastdata/acp19rws/.conda/envs/echi_recipe/lib/python3.11/site-packages/torch_stoi/stoi.py:77: UserWarning: "sinc_interpolation" resampling method name is being deprecated and replaced by "sinc_interp_hann" in the next release. The default behavior remains unchanged.
  self.resample = torchaudio.transforms.Resample(
wandb: Currently logged in as: robbiesuth97 (robbiesuth97-university-of-sheffield) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: creating run
wandb: Tracking run with wandb version 0.20.1
wandb: Run data is saved locally in data/scratch/experiments/baseline_ha/train/wandb/run-20250627_195452-bw07g8gx
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run train
wandb: ⭐️ View project at https://wandb.ai/robbiesuth97-university-of-sheffield/CHiME9-ECHI
wandb: 🚀 View run at https://wandb.ai/robbiesuth97-university-of-sheffield/CHiME9-ECHI/runs/bw07g8gx
[2025-06-27 19:54:54,888][root][INFO] - Training
[2025-06-27 19:54:54,955][root][ERROR] - Invalid # of channels. Requested 7 channels but audio only has 4
Error executing job with overrides: ['device=ha', 'shared.exp_name=baseline_ha']
Traceback (most recent call last):
  File "/mnt/fastdata/acp19rws/Repositories/CHiME9-ECHI/run_train.py", line 21, in main
    run(cfg.dataloading, cfg.model, cfg.train, cfg.base_dir, cfg.debug)
  File "/mnt/fastdata/acp19rws/Repositories/CHiME9-ECHI/scripts/train/train.py", line 222, in run
    processed = model(noisy, spk_id, batch["spkid_lens"]).squeeze(1)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/fastdata/acp19rws/.conda/envs/echi_recipe/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/fastdata/acp19rws/.conda/envs/echi_recipe/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/fastdata/acp19rws/Repositories/CHiME9-ECHI/src/shared/CausalMCxTFGridNet.py", line 152, in forward
    assert mics == self.n_imics
           ^^^^^^^^^^^^^^^^^^^^
AssertionError

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
[1;34mwandb[0m: 
[1;34mwandb[0m: 🚀 View run [33mtrain[0m at: [34mhttps://wandb.ai/robbiesuth97-university-of-sheffield/CHiME9-ECHI/runs/bw07g8gx[0m
